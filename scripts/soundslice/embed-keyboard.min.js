function Pw(a, b) {
    return b ? 0 === b % 12 ? new Ef(a.g,Math.floor(b / 12)) : Df(a.P + b, 0) : a
}
function Qw(a) {
    var b = a.g;
    var c = b.g;
    b = c && !jf[of(b) % 12] || -1 > c || 1 < c ? rf(of(b)) : b;
    return b === a.g ? a : Qf(a.P, Xe[b.g])
}
function Ww(a) {
    var b = a.g;
    return 2 + 7 * (a.j - 1) + b.j + (1 === b.g ? 1 : 0)
}
function Xw(a, b, c, d) {
    a.D = b;
    a.m = c;
    if (d !== a.j)
        for (a.j = d,
        a.C = .55 * d,
        a = a.B,
        d *= .08,
        b = 0; 7 !== b; b++) {
            c = 0;
            if (1 === b || 4 === b)
                c = d;
            else if (6 === b || 3 === b)
                c = -d;
            a[b] = c
        }
}
class Yw {
    constructor(a, b) {
        this.g = a;
        this.G = b;
        this.m = this.C = this.A = this.D = this.j = this.height = this.width = 0;
        this.B = [];
        Xw(this, 52, 0, 20)
    }
}
function Zw(a) {
    this.A = z("keyboard");
    this.C = z("keyboard-nut");
    this.M = a;
    this.g = a.g;
    this.isActive = !1;
    var b = z("keycan");
    Sa(b, 30);
    this.m = new Yw(new Qd(b,this.g.K),a.g.S);
    this.G = this.width = 0;
    this.track = null;
    this.j = !0;
    this.H = this.I = 0;
    this.N = [];
    this.La = !1;
    this.Ta = ()=>{
        if (this.isActive) {
            var c = this.m, d = this.g, e = d.m.j, f = this.track, g = this.N, h = d.D, k, l;
            var m = c.g;
            var p = c.width;
            var n = c.height;
            var q = c.D;
            var r = c.j;
            var v = c.m;
            L(m, "#fff");
            N(m, 0, 0, p, n);
            L(m, "#aaa");
            for (q += 1; q--; )
                N(m, r * q - .5, 0, 1, n);
            N(m, 0, 0, p, 1);
            N(m, 0, n - 1, p, 1);
            L(m, "#999");
            m.g.strokeStyle = "#999";
            Kd(m, r * (23 - v + .5), 7 * n / 8, r / 8, !0);
            Zc(m, 14, 2);
            g.length = 0;
            if (Mp(h)) {
                m = Sp(h, d.g).L;
                var t = Rp(h, d.g);
                d = h.C;
                h = m.m.W;
                for (l = 1 === f.m && this.j ? 2 : 1; l--; )
                    for (p = m.g[f.index + l].g,
                    n = p.length; n--; )
                        for (r = p[n],
                        v = r.length; v--; )
                            if (q = r[v],
                            !xj(q) && (d && me(d, q.m) && je(q.O, d) || !d && t >= q.D / h && t < (q.D + q.N) / h))
                                for (k = q.g.length; k--; ) {
                                    var w = q.g[k];
                                    jf[of(Pw(w.I, e).g) % 12] ? g.push(w) : $w(this, w, !0, t)
                                }
            }
            e = c.g;
            f = c.B;
            m = c.D;
            d = c.j;
            h = c.C;
            p = h / 2;
            n = c.m;
            c = c.A;
            L(e, "#000");
            for (r = n; r !== m + n + 1; r++)
                0 !== r && 52 !== r ? (v = r % 7,
                v = 2 !== v && 5 !== v) : v = !1,
                v && N(e, d * (r - n) - p + f[r % 7], 1, h, c);
            if (l = g.length)
                for (; l--; )
                    $w(this, g[l], !1, t)
        }
        this.La = !1
    }
    ;
    this.K = ()=>{
        this.B()
    }
    ;
    this.D = ()=>{
        ax(this)
    }
    ;
    Bb(this.C, ()=>{
        bx(this);
        this.B()
    }
    )
}
function ax(a) {
    var b = Ia(a.A).width;
    if (a.width !== b) {
        a.width = b;
        cx(a);
        b = a.m;
        var c = a.G;
        if (c !== b.width || 120 !== b.height)
            c !== b.width && Mc(b.g, c),
            120 !== b.height && (Uc(b.g, 120),
            b.A = 78),
            b.width = c,
            b.height = 120
    }
    a.B()
}
function bx(a) {
    if (a.track && 1 === a.track.m && a.j)
        dx(a, a.track, !1);
    else
        for (var b = a.g.A.j, c = null === a.track ? 0 : a.track.index + 1, d = b.length, e; c !== 2 * d; c++)
            if (e = b[c % d],
            e.Ea && !e.fa) {
                dx(a, e, 1 !== e.m || a.j);
                break
            }
}
function cx(a) {
    if (!(30 >= a.width)) {
        var b = a.width - 30
          , c = a.I
          , d = a.H - c + 1
          , e = b / 52 | 0
          , f = 0;
        20 <= e ? d = 52 : (e = b / 20 | 0,
        e < d ? f = c : (f = c - (e - d) / 2 | 0,
        0 > f && (f = 0),
        d = e,
        52 < d + f && (d = 52 - f)),
        e = b / d | 0);
        a.G = e * d;
        Xw(a.m, d, f, e)
    }
}
function dx(a, b, c) {
    if (a.track !== b || a.j !== c) {
        a.track = b;
        a.j = c;
        var d = b.name;
        b.m && (d = 1 === b.m ? d + (c ? " (both)" : " (right)") : d + " (left)");
        a.C.textContent = d;
        b = a.g;
        c = 52;
        d = 0;
        for (var e = 1 === a.track.m && a.j ? 2 : 1, f = b.A.g, g = f.length, h, k, l, m, p, n, q, r; g--; )
            for (r = e; r--; )
                for (h = f[g].g[a.track.index + r].g,
                k = h.length; k--; )
                    for (l = h[k],
                    m = l.length; m--; )
                        for (p = l[m].g,
                        n = p.length; n--; )
                            q = Ww(Qw(Pw(p[n].I, b.m.j))),
                            q > d && (d = q),
                            q < c && (c = q);
        a.I = c;
        a.H = d;
        cx(a)
    }
}
function $w(a, b, c, d) {
    var e = a.g
      , f = e.m;
    d = -2 * qj(b, e.A, d) / 5 + 1;
    var g = Li(b, e.A);
    a = a.m;
    var h = Ww(Qw(Pw(b.I, e.m.j)));
    e = ej(g, f, !0) ? g.A.text : null;
    if (!(0 > h || 52 <= h)) {
        g = a.g;
        var k = a.j
          , l = a.A
          , m = a.C
          , p = a.m;
        L(g, "rgba(" + (2 === b.F.J.track.m ? f.qa : f.oa) + "," + Math.round(100 * d) / 100 + ")");
        c ? (b = k * (h - p),
        N(g, b + .5, 1, k - 1, a.height - 2)) : (b = k * (h - p) - m / 2 + a.B[h % 7],
        N(g, b + 1, 2, m - 2, l - 2));
        null !== e && (f = c ? l + (a.height - l) / 2 : l / 2,
        b += (c ? k : m) / 2,
        L(g, "#ddd"),
        g.g.strokeStyle = "#bbb",
        Kd(g, b, f, 3 * k / 5, !0),
        L(g, "#000"),
        kd(g, e, b - a.G.width(14, 2, e) / 2, f + .2 * k))
    }
}
Zw.prototype = {
    B: ks
};
(()=>{
    var a = soundslice.webui
      , b = null;
    a.g.assign([113], ()=>{
        b || (b = new Zw(a));
        var c = b;
        if (!c.isActive) {
            var d = c.g;
            null === c.track && bx(c);
            d.assign([67, 51, 25, 191], c.K, [195], c.D);
            c.isActive = !0;
            xa(c.A, "active");
            ax(c)
        }
    }
    , [114], ()=>{
        if (b) {
            var c = b;
            if (c.isActive) {
                var d = c.g;
                c.isActive = !1;
                E(c.A, "active");
                Wu(c.M.j);
                lu(d, [67, 51, 25, 191], c.K);
                lu(d, [195], c.D)
            }
        }
    }
    )
}
)();
